<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>payton.scene.geometry.md2 API documentation</title>
    <meta name="description" content="ID Software Quake 2 Model File
Some parts of this file is based on the original work from:
https://g..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#payton.scene.geometry.md2.fix_skin_name">fix_skin_name</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.read_block">read_block</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#payton.scene.geometry.md2.MD2">MD2</a></span>
        
          
  <ul>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.__init__">__init__</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.absolute_vertices">absolute_vertices</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.add_child">add_child</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.add_material">add_material</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.add_triangle">add_triangle</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.animate">animate</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.build">build</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.build_frame">build_frame</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.clear_triangles">clear_triangles</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.compile">compile</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.destroy">destroy</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.direct_to">direct_to</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.fix_normals">fix_normals</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.fix_texcoords">fix_texcoords</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.forward">forward</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.hide">hide</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.load_buffer">load_buffer</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.load_file">load_file</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.load_frames">load_frames</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.read_frame">read_frame</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.read_header">read_header</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.read_skin">read_skin</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.read_tex_coords">read_tex_coords</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.read_triangles">read_triangles</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.refresh">refresh</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.render">render</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.rotate_around_x">rotate_around_x</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.rotate_around_y">rotate_around_y</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.rotate_around_z">rotate_around_z</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.scale">scale</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.select">select</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.show">show</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.step_back">step_back</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.to_absolute">to_absolute</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.to_dict">to_dict</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.to_json">to_json</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.toggle_wireframe">toggle_wireframe</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.track">track</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.update_matrix">update_matrix</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.from_dict">from_dict</a></li>
    <li class="mono"><a href="#payton.scene.geometry.md2.MD2.from_json">from_json</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#payton.scene.geometry.md2.MD2Frame">MD2Frame</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#payton.scene.geometry.md2.MD2Header">MD2Header</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#payton.scene.geometry.md2.MD2TriangleLayout">MD2TriangleLayout</a></span>
        
        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">payton.scene.geometry.md2</span> module</h1>
  <p>ID Software Quake 2 Model File
Some parts of this file is based on the original work from:
https://github.com/adamlwgriffiths/PyMesh/tree/master/pymesh/md2</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ID Software Quake 2 Model File</span>
<span class="sd">Some parts of this file is based on the original work from:</span>
<span class="sd">https://github.com/adamlwgriffiths/PyMesh/tree/master/pymesh/md2</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">NamedTuple</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c1"># type: ignore</span>

<span class="kn">from</span> <span class="nn">payton.math.vector</span> <span class="kn">import</span> <span class="n">plane_normal</span>
<span class="kn">from</span> <span class="nn">payton.scene.geometry.mesh</span> <span class="kn">import</span> <span class="n">Mesh</span>
<span class="kn">from</span> <span class="nn">payton.scene.light</span> <span class="kn">import</span> <span class="n">Light</span>

<span class="n">_SIGNATURE</span> <span class="o">=</span> <span class="s2">&quot;IDP2&quot;</span>
<span class="n">_VERSION</span> <span class="o">=</span> <span class="mi">8</span>


<span class="k">class</span> <span class="nc">MD2Header</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">ident</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">skin_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">skin_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">frame_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_skins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_vertices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_st</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_tris</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_glcmds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_skins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_st</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_tris</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_glcmds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">MD2Frame</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">vertices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">normals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">class</span> <span class="nc">MD2TriangleLayout</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">vertex_indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tc_indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">read_block</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">format_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">yield_size</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">size</span>
            <span class="k">yield</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="n">yield_size</span><span class="p">]</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">size</span>

    <span class="n">struct_length</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="n">format_str</span><span class="p">)</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="n">struct_length</span> <span class="o">*</span> <span class="n">count</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">total_length</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">total_length</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MD2: Failed to read &#39;</span><span class="si">%d</span><span class="s2">&#39; bytes&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">total_length</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">format_str</span><span class="p">,</span> <span class="n">chunk</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">struct_length</span><span class="p">)</span>
    <span class="p">]</span>


<span class="k">def</span> <span class="nf">fix_skin_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">name_str</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">name_parts</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name_str</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.pcx&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;{name_parts[0]}.pcx&quot;</span>
    <span class="k">return</span> <span class="n">name_str</span>


<span class="k">class</span> <span class="nc">MD2</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MD2 File Format Loader</span>
<span class="sd">    I know that this is a pretty old file format. We can consider it as ancient</span>
<span class="sd">    On the other hand, our target on creating Payton is not to make a game</span>
<span class="sd">    engine.</span>

<span class="sd">    Also note that there might be some bugs, I give no guarantee here.</span>
<span class="sd">    As this is a generic class, I haven&#39;t defined any animations before hand.</span>
<span class="sd">    So to make things properly looping in your code, you need to set the</span>
<span class="sd">    animation frame ranges yourself. For instance, as you will see at the</span>
<span class="sd">    defined example, infantry has a perfect walking loop between frames 2-13</span>

<span class="sd">    Unlike original frame names, frames in this class starts from 0 and goes</span>
<span class="sd">    incremented by one.</span>

<span class="sd">    NOTE: There are some hard-coded pre-assumptions like the scale of the</span>
<span class="sd">    objects and they are just defined to look okay on a default scene.</span>

<span class="sd">    Example use case:</span>

<span class="sd">        .. include:: ../../../examples/basics/26_quake2.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the MD2 Object</span>

<span class="sd">        Args:</span>
<span class="sd">          filename: Filename to load</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="n">MD2Header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MD2Frame</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">animation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">from_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">to_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the model in motion</span>

<span class="sd">        Args:</span>
<span class="sd">          animation_name: Name of the animation to play</span>
<span class="sd">          from_frame: Loop starting frame</span>
<span class="sd">          to_frame: Loop ending frame</span>
<span class="sd">          loop: Loop the animation?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># For thread safety</span>
        <span class="k">if</span> <span class="n">animation_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Animation {animation_name} not found in object&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">animation_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">from_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">from_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;from_frame out of bounds&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">to_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">to_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;to_frame out of bounds&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span> <span class="o">=</span> <span class="n">loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">=</span> <span class="n">to_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation_name</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">proj</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">view</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">lights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Light</span><span class="p">],</span>
        <span class="n">parent_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_missing_vao</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_needs_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
                    <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
                <span class="p">)</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">tdiff</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tdiff</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_matrix</span><span class="p">(</span><span class="n">parent_matrix</span><span class="o">=</span><span class="n">parent_matrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">()</span>

        <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{self.animation}{self._active_frame}&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">frame_name</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
            <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;File not found: {filename}&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_buffer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_header</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_skin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_tex_coords</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_triangles</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_tris</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 6H&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_tris</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
        <span class="p">)</span>
        <span class="n">triangles</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">tc_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">(</span>
            <span class="n">vertex_indices</span><span class="o">=</span><span class="n">vertex_indices</span><span class="p">,</span> <span class="n">tc_indices</span><span class="o">=</span><span class="n">tc_indices</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{name}{num}&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_information</span><span class="p">:</span> <span class="n">MD2Frame</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">vertex_indices</span><span class="p">):</span>
            <span class="n">v3</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">add_triangle</span><span class="p">(</span>
                <span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span>
                <span class="n">normals</span><span class="o">=</span><span class="p">[</span><span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">],</span>
                <span class="n">texcoords</span><span class="o">=</span><span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">mesh</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">texture</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 4s16l&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_SIGNATURE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;MD2 Identifier is incorrect&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">version</span> <span class="o">!=</span> <span class="n">_VERSION</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;Invalid Version&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_skin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_skins</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">skin_struct</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">Struct</span><span class="p">(</span><span class="s2">&quot;&lt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;64s&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_skins</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">skins</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">fix_skin_name</span><span class="p">(</span><span class="n">skin</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">skin</span> <span class="ow">in</span> <span class="n">skin_struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">skin_struct</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_tex_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_st</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 2h&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_st</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span>
        <span class="p">)</span>
        <span class="n">tcs</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">tcs</span> <span class="o">/=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_width</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_height</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="n">tcs</span>

    <span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_frames</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_frame</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">frame_translations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 3f&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">translation</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 16s&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">frame_vertex_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt;4B&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
        <span class="p">)</span>

        <span class="n">frame_vertex_data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">vertices_short</span> <span class="o">=</span> <span class="n">frame_vertex_data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices_short</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">vertices</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="n">vertices</span> <span class="o">+=</span> <span class="p">(</span><span class="n">translation</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">translation</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">vertices</span> <span class="o">/=</span> <span class="mf">20.0</span>

        <span class="k">return</span> <span class="n">MD2Frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.fix_skin_name">
    <p>def <span class="ident">fix_skin_name</span>(</p><p>name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.fix_skin_name', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.fix_skin_name" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">fix_skin_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">name_str</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">name_parts</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name_str</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.pcx&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;{name_parts[0]}.pcx&quot;</span>
    <span class="k">return</span> <span class="n">name_str</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.read_block">
    <p>def <span class="ident">read_block</span>(</p><p>b, format_str, count)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.read_block', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.read_block" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_block</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">format_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">yield_size</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">size</span>
            <span class="k">yield</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="n">yield_size</span><span class="p">]</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">size</span>

    <span class="n">struct_length</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="n">format_str</span><span class="p">)</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="n">struct_length</span> <span class="o">*</span> <span class="n">count</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">total_length</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">total_length</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MD2: Failed to read &#39;</span><span class="si">%d</span><span class="s2">&#39; bytes&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">total_length</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">format_str</span><span class="p">,</span> <span class="n">chunk</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">struct_length</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="payton.scene.geometry.md2.MD2" class="name">class <span class="ident">MD2</span></p>
      
  
    <div class="desc"><p>MD2 File Format Loader
I know that this is a pretty old file format. We can consider it as ancient
On the other hand, our target on creating Payton is not to make a game
engine.</p>
<p>Also note that there might be some bugs, I give no guarantee here.
As this is a generic class, I haven't defined any animations before hand.
So to make things properly looping in your code, you need to set the
animation frame ranges yourself. For instance, as you will see at the
defined example, infantry has a perfect walking loop between frames 2-13</p>
<p>Unlike original frame names, frames in this class starts from 0 and goes
incremented by one.</p>
<p>NOTE: There are some hard-coded pre-assumptions like the scale of the
objects and they are just defined to look okay on a default scene.</p>
<p>Example use case:</p>
<div class="codehilite"><pre><span></span>.. <span class="k">include</span>:: ..<span class="o">/</span>..<span class="o">/</span>..<span class="o">/</span><span class="nv">examples</span><span class="o">/</span><span class="nv">basics</span><span class="o">/</span><span class="mi">26</span><span class="nv">_quake2</span>.<span class="nv">py</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MD2</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MD2 File Format Loader</span>
<span class="sd">    I know that this is a pretty old file format. We can consider it as ancient</span>
<span class="sd">    On the other hand, our target on creating Payton is not to make a game</span>
<span class="sd">    engine.</span>

<span class="sd">    Also note that there might be some bugs, I give no guarantee here.</span>
<span class="sd">    As this is a generic class, I haven&#39;t defined any animations before hand.</span>
<span class="sd">    So to make things properly looping in your code, you need to set the</span>
<span class="sd">    animation frame ranges yourself. For instance, as you will see at the</span>
<span class="sd">    defined example, infantry has a perfect walking loop between frames 2-13</span>

<span class="sd">    Unlike original frame names, frames in this class starts from 0 and goes</span>
<span class="sd">    incremented by one.</span>

<span class="sd">    NOTE: There are some hard-coded pre-assumptions like the scale of the</span>
<span class="sd">    objects and they are just defined to look okay on a default scene.</span>

<span class="sd">    Example use case:</span>

<span class="sd">        .. include:: ../../../examples/basics/26_quake2.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the MD2 Object</span>

<span class="sd">        Args:</span>
<span class="sd">          filename: Filename to load</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="n">MD2Header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MD2Frame</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">animation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">from_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">to_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the model in motion</span>

<span class="sd">        Args:</span>
<span class="sd">          animation_name: Name of the animation to play</span>
<span class="sd">          from_frame: Loop starting frame</span>
<span class="sd">          to_frame: Loop ending frame</span>
<span class="sd">          loop: Loop the animation?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># For thread safety</span>
        <span class="k">if</span> <span class="n">animation_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Animation {animation_name} not found in object&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">animation_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">from_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">from_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;from_frame out of bounds&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">to_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">to_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;to_frame out of bounds&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span> <span class="o">=</span> <span class="n">loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">=</span> <span class="n">to_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation_name</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">proj</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">view</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">lights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Light</span><span class="p">],</span>
        <span class="n">parent_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_missing_vao</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_needs_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
                    <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
                <span class="p">)</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">tdiff</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tdiff</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_matrix</span><span class="p">(</span><span class="n">parent_matrix</span><span class="o">=</span><span class="n">parent_matrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">()</span>

        <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{self.animation}{self._active_frame}&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">frame_name</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
            <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;File not found: {filename}&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_buffer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_header</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_skin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_tex_coords</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_triangles</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_tris</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 6H&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_tris</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
        <span class="p">)</span>
        <span class="n">triangles</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">tc_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">(</span>
            <span class="n">vertex_indices</span><span class="o">=</span><span class="n">vertex_indices</span><span class="p">,</span> <span class="n">tc_indices</span><span class="o">=</span><span class="n">tc_indices</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{name}{num}&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_information</span><span class="p">:</span> <span class="n">MD2Frame</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">vertex_indices</span><span class="p">):</span>
            <span class="n">v3</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">add_triangle</span><span class="p">(</span>
                <span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span>
                <span class="n">normals</span><span class="o">=</span><span class="p">[</span><span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">],</span>
                <span class="n">texcoords</span><span class="o">=</span><span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">mesh</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">texture</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 4s16l&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_SIGNATURE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;MD2 Identifier is incorrect&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">version</span> <span class="o">!=</span> <span class="n">_VERSION</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;Invalid Version&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_skin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_skins</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">skin_struct</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">Struct</span><span class="p">(</span><span class="s2">&quot;&lt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;64s&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_skins</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">skins</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">fix_skin_name</span><span class="p">(</span><span class="n">skin</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">skin</span> <span class="ow">in</span> <span class="n">skin_struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">skin_struct</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_tex_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_st</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 2h&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_st</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span>
        <span class="p">)</span>
        <span class="n">tcs</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">tcs</span> <span class="o">/=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_width</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_height</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="n">tcs</span>

    <span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_frames</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_frame</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
        <span class="n">frame_translations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 3f&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">translation</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 16s&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">frame_vertex_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt;4B&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
        <span class="p">)</span>

        <span class="n">frame_vertex_data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">vertices_short</span> <span class="o">=</span> <span class="n">frame_vertex_data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices_short</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">vertices</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="n">vertices</span> <span class="o">+=</span> <span class="p">(</span><span class="n">translation</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">translation</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">vertices</span> <span class="o">/=</span> <span class="mf">20.0</span>

        <span class="k">return</span> <span class="n">MD2Frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#payton.scene.geometry.md2.MD2">MD2</a></li>
          <li>payton.scene.geometry.mesh.Mesh</li>
          <li>payton.scene.geometry.base.Object</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, filename=&#39;&#39;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the MD2 Object</p>
<p>Args:
  filename: Filename to load</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.__init__', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the MD2 Object</span>
<span class="sd">    Args:</span>
<span class="sd">      filename: Filename to load</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="n">MD2Header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MD2Frame</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.absolute_vertices">
    <p>def <span class="ident">absolute_vertices</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a map of all local vertices as absolute coordinates.</p>
<p>Imagine that object B is a child of object A. In this case, B will
always stand (follow) relative to A. If you want to know the exact
world coordinates of all vertices in B, this method will return them.</p>
<p><strong>Important!</strong> This is a costly operation so use with caution!</p>
<p>Returns:
  map(List[List[float]])</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.absolute_vertices', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.absolute_vertices" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">absolute_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Return a map of all local vertices as absolute coordinates.</span>
<span class="sd">    Imagine that object B is a child of object A. In this case, B will</span>
<span class="sd">    always stand (follow) relative to A. If you want to know the exact</span>
<span class="sd">    world coordinates of all vertices in B, this method will return them.</span>
<span class="sd">    **Important!** This is a costly operation so use with caution!</span>
<span class="sd">    Returns:</span>
<span class="sd">      map(List[List[float]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_absolute</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.add_child">
    <p>def <span class="ident">add_child</span>(</p><p>self, name, obj)</p>
    </div>
    

    
  
    <div class="desc"><p>Add child to this object.</p>
<p>In a basic example:</p>
<div class="codehilite"><pre><span></span>.. <span class="k">include</span>:: ..<span class="o">/</span>..<span class="o">/</span>..<span class="o">/</span><span class="nv">examples</span><span class="o">/</span><span class="nv">basics</span><span class="o">/</span><span class="mi">05</span><span class="nv">_children</span>.<span class="nv">py</span>
</pre></div>


<p>Args:
  name: Name of the object, must be unique within its siblings
  obj: Object. Must be an instance of
       <code>payton.scene.geometry.base.Object</code></p>
<p>Returns:
  bool: False in case of an error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.add_child', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.add_child" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;Object&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add child to this object.</span>
<span class="sd">    In a basic example:</span>
<span class="sd">        .. include:: ../../../examples/basics/05_children.py</span>
<span class="sd">    Args:</span>
<span class="sd">      name: Name of the object, must be unique within its siblings</span>
<span class="sd">      obj: Object. Must be an instance of</span>
<span class="sd">           `payton.scene.geometry.base.Object`</span>
<span class="sd">    Returns:</span>
<span class="sd">      bool: False in case of an error</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Name {name} exists in object children&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Object</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Object type is not valid&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.add_material">
    <p>def <span class="ident">add_material</span>(</p><p>self, name, material)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a material to the object.</p>
<p>Keep in mind that, adding material does not refer to the material
but does it through deepcopy. Initially, material holds indice
and vertex buffer objectt references. In order to prevent user
from breaking the objects, we create the clone of the material.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.add_material', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.add_material" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">material</span><span class="p">:</span> <span class="n">Material</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add a material to the object.</span>
<span class="sd">    Keep in mind that, adding material does not refer to the material</span>
<span class="sd">    but does it through deepcopy. Initially, material holds indice</span>
<span class="sd">    and vertex buffer objectt references. In order to prevent user</span>
<span class="sd">    from breaking the objects, we create the clone of the material.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Name {name} already exists&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">material</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.add_triangle">
    <p>def <span class="ident">add_triangle</span>(</p><p>self, vertices, material=&#39;default&#39;, normals=None, texcoords=None, colors=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Add triangle to Mesh</p>
<p>Args:
  vertices: Vertices of the triangle. This is required. Ex:
            <code>[[0, 0, 0], [2, 0, 0], [1, 1, 0]]</code>
  normals: Normals of the triangle. <em>(When left as None, Payton will
           calculate the surface normal based on vertices and assign
           it per given vertex.)</em>
  material: Name of the material to use.
  texcoords: Texture UV coordinates.
  colors: Per vertex colors (optional)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.add_triangle', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.add_triangle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_triangle</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">vertices</span><span class="p">:</span> <span class="n">VList</span><span class="p">,</span>
    <span class="n">material</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT</span><span class="p">,</span>
    <span class="n">normals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VList</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">texcoords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VList</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VList</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add triangle to Mesh</span>
<span class="sd">    Args:</span>
<span class="sd">      vertices: Vertices of the triangle. This is required. Ex:</span>
<span class="sd">                `[[0, 0, 0], [2, 0, 0], [1, 1, 0]]`</span>
<span class="sd">      normals: Normals of the triangle. _(When left as None, Payton will</span>
<span class="sd">               calculate the surface normal based on vertices and assign</span>
<span class="sd">               it per given vertex.)_</span>
<span class="sd">      material: Name of the material to use.</span>
<span class="sd">      texcoords: Texture UV coordinates.</span>
<span class="sd">      colors: Per vertex colors (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;A triangle must have 3 vertices&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">normals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">normals</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;There must be one normal per vertex&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">texcoords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">texcoords</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;There must be one texcoord per vertex&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">normals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
        <span class="n">normals</span> <span class="o">=</span> <span class="p">[</span><span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">texcoords</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">texcoords</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">colors</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">+=</span> <span class="n">vertices</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">material</span><span class="p">]</span><span class="o">.</span><span class="n">_indices</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">normal</span> <span class="ow">in</span> <span class="n">normals</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">texcoords</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.animate">
    <p>def <span class="ident">animate</span>(</p><p>self, animation_name, from_frame, to_frame, loop=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Set the model in motion</p>
<p>Args:
  animation_name: Name of the animation to play
  from_frame: Loop starting frame
  to_frame: Loop ending frame
  loop: Loop the animation?</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.animate', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.animate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">animate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">animation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">from_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">to_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the model in motion</span>
<span class="sd">    Args:</span>
<span class="sd">      animation_name: Name of the animation to play</span>
<span class="sd">      from_frame: Loop starting frame</span>
<span class="sd">      to_frame: Loop ending frame</span>
<span class="sd">      loop: Loop the animation?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># For thread safety</span>
    <span class="k">if</span> <span class="n">animation_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Animation {animation_name} not found in object&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">animation_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">from_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">from_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;from_frame out of bounds&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">to_frame</span> <span class="o">&lt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">to_frame</span> <span class="o">&gt;</span> <span class="n">anim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;to_frame out of bounds&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span> <span class="o">=</span> <span class="n">loop</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span> <span class="o">=</span> <span class="n">from_frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">=</span> <span class="n">to_frame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">animation_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.build">
    <p>def <span class="ident">build</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Build OpenGL Vertex Array for the object</p>
<p>This function gets automatically called if material's <code>._vao</code> does not
exists in the first render cycle. Once the vba is built,
geometry changes or material display mode changes will not be
automatically effected. So, in every geometry or display mode
change, a <code>build</code> call is necessary.</p>
<p>If <code>self.static</code> is <code>True</code>, then the system assumes that another update
call is not expected, thus frees <code>_normals</code>, <code>_textcoords</code>,
<code>_vertices</code> and <code>_indices</code> lists to free memory.
So in this case, calling <code>build</code> function twice will result in
an invisible object (will not be drawn).</p>
<p>Additionally, this method goes through each material mapping and
build their indices as well. Each material map has its own
Vertex Array Object and gets rendered by separate glDrawElements
call.</p>
<p>Returns:
  bool</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.build', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.build" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build OpenGL Vertex Array for the object</span>
<span class="sd">    This function gets automatically called if material&#39;s `._vao` does not</span>
<span class="sd">    exists in the first render cycle. Once the vba is built,</span>
<span class="sd">    geometry changes or material display mode changes will not be</span>
<span class="sd">    automatically effected. So, in every geometry or display mode</span>
<span class="sd">    change, a `build` call is necessary.</span>
<span class="sd">    If `self.static` is `True`, then the system assumes that another update</span>
<span class="sd">    call is not expected, thus frees `_normals`, `_textcoords`,</span>
<span class="sd">    `_vertices` and `_indices` lists to free memory.</span>
<span class="sd">    So in this case, calling `build` function twice will result in</span>
<span class="sd">    an invisible object (will not be drawn).</span>
<span class="sd">    Additionally, this method goes through each material mapping and</span>
<span class="sd">    build their indices as well. Each material map has its own</span>
<span class="sd">    Vertex Array Object and gets rendered by separate glDrawElements</span>
<span class="sd">    call.</span>
<span class="sd">    Returns:</span>
<span class="sd">      bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Turn python arrays into C type arrays using Numpy.</span>
    <span class="c1"># This is required for OpenGL. Python memory model is a bit</span>
    <span class="c1"># different than raw memory model of C (OpenGL)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">normals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">texcoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertex_colors</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vao</span> <span class="o">==</span> <span class="n">NO_INDICE</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vao</span> <span class="o">==</span> <span class="n">NO_VERTEX_ARRAY</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vao</span> <span class="o">=</span> <span class="n">glGenVertexArrays</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span> <span class="o">=</span> <span class="n">glGenBuffers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1"># We will let all materials to share the same buffer objects</span>
    <span class="c1"># We need 4 buffers (vertex, normal, texcoord, color)</span>
    <span class="n">glBindVertexArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vao</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_calc_bounds</span><span class="p">()</span>
    <span class="c1"># OpenGL allocates buffers in different mechanisms between</span>
    <span class="c1"># STATIC and DYNAMIC draw modes. If you select STATIC, then OpenGL</span>
    <span class="c1"># will assume that object buffer will not change and allocate it in a</span>
    <span class="c1"># more suitable way.</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">GL_STATIC_DRAW</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">static</span><span class="p">:</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="n">GL_DYNAMIC_DRAW</span>
    <span class="c1"># Buffer overflow, we need more space.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">&lt;</span> <span class="n">vertices</span><span class="o">.</span><span class="n">nbytes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">vertices</span><span class="o">.</span><span class="n">nbytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size_changed</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size</span> <span class="o">&lt;</span> <span class="n">texcoords</span><span class="o">.</span><span class="n">nbytes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size</span> <span class="o">=</span> <span class="n">texcoords</span><span class="o">.</span><span class="n">nbytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size_changed</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># Bind Vertices</span>
    <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size_changed</span><span class="p">:</span>
        <span class="c1"># glBufferData creates a new data area</span>
        <span class="n">glBufferData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">draw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># glBufferSubData just replaces memory area in buffer so it is</span>
        <span class="c1"># much more efficient way to handle things.</span>
        <span class="n">glBufferSubData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vertices</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>
    <span class="c1"># Bind Normals</span>
    <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size_changed</span><span class="p">:</span>
        <span class="n">glBufferData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">draw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">glBufferSubData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">normals</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">normals</span><span class="p">)</span>
    <span class="c1"># Bind TexCoords</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">):</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size_changed</span><span class="p">:</span>
            <span class="n">glBufferData</span><span class="p">(</span>
                <span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size</span><span class="p">,</span> <span class="n">texcoords</span><span class="p">,</span> <span class="n">draw</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">glBufferSubData</span><span class="p">(</span>
                <span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">texcoords</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">texcoords</span>
            <span class="p">)</span>
    <span class="c1"># Bind Vertex Colors</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertex_colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">):</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_vertex_colors</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size_changed</span><span class="p">:</span>
            <span class="n">glBufferData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">draw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">glBufferSubData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colors</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">glBindVertexArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size_changed</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_t_buffer_size_changed</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">material</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">material</span><span class="o">.</span><span class="n">_vao</span> <span class="o">==</span> <span class="n">NO_INDICE</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">material</span><span class="o">.</span><span class="n">_vao</span> <span class="o">==</span> <span class="n">NO_VERTEX_ARRAY</span><span class="p">:</span>
            <span class="c1"># Generate Vertex Array</span>
            <span class="n">material</span><span class="o">.</span><span class="n">_vao</span> <span class="o">=</span> <span class="n">glGenVertexArrays</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># We need 1 buffer for material as indices</span>
            <span class="n">material</span><span class="o">.</span><span class="n">_vbos</span> <span class="o">=</span> <span class="p">[</span><span class="n">glGenBuffers</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">glBindVertexArray</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">_vao</span><span class="p">)</span>
            <span class="c1"># Material shader must be built when there is an active binding</span>
            <span class="c1"># to vertex array</span>
            <span class="n">material</span><span class="o">.</span><span class="n">build_shader</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># we already have vertex array object, just bind it to modify</span>
            <span class="n">glBindVertexArray</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">_vao</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="c1"># Bind Vertices</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">glEnableVertexAttribArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># shader layout location</span>
        <span class="n">glVertexAttribPointer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">GL_FLOAT</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Bind Normals</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">glEnableVertexAttribArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># shader layout location</span>
        <span class="n">glVertexAttribPointer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">GL_FLOAT</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Bind TexCoords</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">):</span>
            <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">glEnableVertexAttribArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># shader layout location</span>
            <span class="n">glVertexAttribPointer</span><span class="p">(</span>
                <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GL_FLOAT</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Bind Vertex Colors</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertex_colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">):</span>
            <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">glEnableVertexAttribArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># shader layout location</span>
            <span class="n">glVertexAttribPointer</span><span class="p">(</span>
                <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">GL_FLOAT</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Bind Indices</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ELEMENT_ARRAY_BUFFER</span><span class="p">,</span> <span class="n">material</span><span class="o">.</span><span class="n">_vbos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">glBufferData</span><span class="p">(</span>
            <span class="n">GL_ELEMENT_ARRAY_BUFFER</span><span class="p">,</span> <span class="n">indices</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">draw</span>
        <span class="p">)</span>
        <span class="n">i_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">material</span><span class="o">.</span><span class="n">_vertex_count</span> <span class="o">=</span> <span class="n">i_len</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_count</span> <span class="o">+=</span> <span class="n">i_len</span>
        <span class="n">glBindVertexArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">static</span><span class="p">:</span>
        <span class="c1"># we can clear this data to free some more memory</span>
        <span class="n">glDeleteBuffers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vbos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_needs_update</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.build_frame">
    <p>def <span class="ident">build_frame</span>(</p><p>self, frame_information, name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.build_frame', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.build_frame" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_information</span><span class="p">:</span> <span class="n">MD2Frame</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tri</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">vertex_indices</span><span class="p">):</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">frame_information</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">tri</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span><span class="o">.</span><span class="n">tc_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">add_triangle</span><span class="p">(</span>
            <span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span>
            <span class="n">normals</span><span class="o">=</span><span class="p">[</span><span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">normal</span><span class="p">],</span>
            <span class="n">texcoords</span><span class="o">=</span><span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">texture</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.clear_triangles">
    <p>def <span class="ident">clear_triangles</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clear all triangles inside the Mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.clear_triangles', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.clear_triangles" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Clear all triangles inside the Mesh&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">material</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">material</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.compile">
    <p>def <span class="ident">compile</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.compile', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.compile" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">animations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{name}{num}&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame_name</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.destroy">
    <p>def <span class="ident">destroy</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroy objects self.</p>
<p>Returns:
    bool: <code>True</code> on successful destroy of <code>self</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.destroy', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.destroy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroy objects self.</span>
<span class="sd">    Returns:</span>
<span class="sd">        bool: `True` on successful destroy of `self`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">material</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">material</span><span class="o">.</span><span class="n">_vao</span> <span class="o">&gt;</span> <span class="n">NO_VERTEX_ARRAY</span><span class="p">:</span>
            <span class="n">glDeleteVertexArrays</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vao</span><span class="p">])</span>
            <span class="n">material</span><span class="o">.</span><span class="n">_vao</span> <span class="o">=</span> <span class="n">NO_VERTEX_ARRAY</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vao</span> <span class="o">&gt;</span> <span class="n">NO_VERTEX_ARRAY</span><span class="p">:</span>
        <span class="n">glDeleteVertexArrays</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vao</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vao</span> <span class="o">=</span> <span class="n">NO_VERTEX_ARRAY</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.direct_to">
    <p>def <span class="ident">direct_to</span>(</p><p>self, v)</p>
    </div>
    

    
  
    <div class="desc"><p>Direct the objects forward towards given point vector</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.direct_to', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.direct_to" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">direct_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Direct the objects forward towards given point vector&quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">sub_vector</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">normalize_vector</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">diff</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.fix_normals">
    <p>def <span class="ident">fix_normals</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Try to re-calculate Mesh normals, if your object has already perfect
normals, do not call this method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.fix_normals', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.fix_normals" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">fix_normals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Try to re-calculate Mesh normals, if your object has already perfect</span>
<span class="sd">    normals, do not call this method&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">:</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">)</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">normal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">normal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">normal</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.fix_texcoords">
    <p>def <span class="ident">fix_texcoords</span>(</p><p>self, u=1, v=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Try to recalculate mesh texture coordinates by cube projection</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.fix_texcoords', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.fix_texcoords" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">fix_texcoords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Try to recalculate mesh texture coordinates by cube projection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_calc_bounds</span><span class="p">()</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounding_box</span>
    <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">normals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># front</span>
        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># right</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># left</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># back</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  <span class="c1"># top</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>  <span class="c1"># bottom</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">:</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">face</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">)</span>
        <span class="c1"># find face normal</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">plane_normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
        <span class="c1"># determine which face of the cube</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">vector_angle</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">normals</span><span class="p">]</span>
        <span class="n">face_dir</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">angles</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">face_dir</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">width</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">depth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">t1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="p">[</span><span class="n">t2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="n">s3</span><span class="p">]])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="p">[[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.forward">
    <p>def <span class="ident">forward</span>(</p><p>self, distance)</p>
    </div>
    

    
  
    <div class="desc"><p>Move object forward</p>
<p>This method calculates to motion path according to direction
of the object's matrix. <code>self.matrix[1]</code> indicates the direction.</p>
<p>So matrix position gets updated according to direction * distance</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.forward', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.forward" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Move object forward</span>
<span class="sd">    This method calculates to motion path according to direction</span>
<span class="sd">    of the object&#39;s matrix. `self.matrix[1]` indicates the direction.</span>
<span class="sd">    So matrix position gets updated according to direction * distance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">scale_vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">distance</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_vectors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">diff</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.hide">
    <p>def <span class="ident">hide</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.hide', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.hide" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.load_buffer">
    <p>def <span class="ident">load_buffer</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.load_buffer', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.load_buffer" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">read_header</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">read_skin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">read_tex_coords</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">read_triangles</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.load_file">
    <p>def <span class="ident">load_file</span>(</p><p>self, filename)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.load_file', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.load_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;File not found: {filename}&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_buffer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.load_frames">
    <p>def <span class="ident">load_frames</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.load_frames', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.load_frames" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_frames</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_frame</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.read_frame">
    <p>def <span class="ident">read_frame</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.read_frame', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.read_frame" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="n">frame_translations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 3f&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">translation</span> <span class="o">=</span> <span class="n">frame_translations</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 16s&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">frame_vertex_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt;4B&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_vertices</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
    <span class="p">)</span>
    <span class="n">frame_vertex_data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">vertices_short</span> <span class="o">=</span> <span class="n">frame_vertex_data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices_short</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">*=</span> <span class="n">scale</span>
    <span class="n">vertices</span> <span class="o">+=</span> <span class="p">(</span><span class="n">translation</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">translation</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">/=</span> <span class="mf">20.0</span>
    <span class="k">return</span> <span class="n">MD2Frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.read_header">
    <p>def <span class="ident">read_header</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.read_header', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.read_header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">MD2Header</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 4s16l&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_SIGNATURE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;MD2 Identifier is incorrect&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">version</span> <span class="o">!=</span> <span class="n">_VERSION</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="s2">&quot;Invalid Version&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.read_skin">
    <p>def <span class="ident">read_skin</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.read_skin', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.read_skin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_skin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_skins</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
    <span class="n">skin_struct</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">Struct</span><span class="p">(</span><span class="s2">&quot;&lt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;64s&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_skins</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skins</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">fix_skin_name</span><span class="p">(</span><span class="n">skin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">skin</span> <span class="ow">in</span> <span class="n">skin_struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">skin_struct</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.read_tex_coords">
    <p>def <span class="ident">read_tex_coords</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.read_tex_coords', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.read_tex_coords" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_tex_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_st</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
    <span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 2h&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_st</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span>
    <span class="p">)</span>
    <span class="n">tcs</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">tcs</span> <span class="o">/=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_width</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">skin_height</span><span class="p">)]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="n">tcs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.read_triangles">
    <p>def <span class="ident">read_triangles</span>(</p><p>self, f)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.read_triangles', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.read_triangles" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">offset_tris</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>
    <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">read_block</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;&lt; 6H&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">num_tris</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
    <span class="p">)</span>
    <span class="n">triangles</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">tc_indices</span> <span class="o">=</span> <span class="n">triangles</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">triangle_layout</span> <span class="o">=</span> <span class="n">MD2TriangleLayout</span><span class="p">(</span>
        <span class="n">vertex_indices</span><span class="o">=</span><span class="n">vertex_indices</span><span class="p">,</span> <span class="n">tc_indices</span><span class="o">=</span><span class="n">tc_indices</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.refresh">
    <p>def <span class="ident">refresh</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Refresh object</p>
<p>Forces object to get built again</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.refresh', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.refresh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Refresh object</span>
<span class="sd">    Forces object to get built again</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_needs_update</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.render">
    <p>def <span class="ident">render</span>(</p><p>self, proj, view, lights, parent_matrix=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Virtual function for rendering the object. Some objects can overwrite
this function.</p>
<p>Args:
  proj: Camera projection matrix.
  view: Camera location/view matrix.
  lights: Light objects in the scene
  parent_matrix: Parent matrix is the matrix of the parent. Parent can
                 be the scene itself or another object. In case of
                 another object, object will position itself relative
                 to its parent object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.render', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">proj</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">lights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Light</span><span class="p">],</span>
    <span class="n">parent_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_missing_vao</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_needs_update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
                <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">tdiff</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tdiff</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_rate</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_frame</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_frame</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_active_frame</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_matrix</span><span class="p">(</span><span class="n">parent_matrix</span><span class="o">=</span><span class="n">parent_matrix</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">()</span>
    <span class="n">frame_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{self.animation}{self._active_frame}&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">frame_name</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
        <span class="n">proj</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">lights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.rotate_around_x">
    <p>def <span class="ident">rotate_around_x</span>(</p><p>self, angle)</p>
    </div>
    

    
  
    <div class="desc"><p>Pitch - Rotate around X axis</p>
<p>Args:
  angle: Angle in radians</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.rotate_around_x', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.rotate_around_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rotate_around_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Pitch - Rotate around X axis</span>
<span class="sd">    Args:</span>
<span class="sd">      angle: Angle in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rot_matrix</span> <span class="o">=</span> <span class="n">create_rotation_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">rot_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">local_matrix</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">local_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.rotate_around_y">
    <p>def <span class="ident">rotate_around_y</span>(</p><p>self, angle)</p>
    </div>
    

    
  
    <div class="desc"><p>Roll - Rotate around Y Axis (Direction)</p>
<p>Args:
  angle: Angle in radians</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.rotate_around_y', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.rotate_around_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rotate_around_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Roll - Rotate around Y Axis (Direction)</span>
<span class="sd">    Args:</span>
<span class="sd">      angle: Angle in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rot_matrix</span> <span class="o">=</span> <span class="n">create_rotation_matrix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">rot_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">local_matrix</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">local_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.rotate_around_z">
    <p>def <span class="ident">rotate_around_z</span>(</p><p>self, angle)</p>
    </div>
    

    
  
    <div class="desc"><p>Rotate around Z Axis</p>
<p>Args:
  angle: Angle in radians</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.rotate_around_z', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.rotate_around_z" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rotate_around_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Rotate around Z Axis</span>
<span class="sd">    Args:</span>
<span class="sd">      angle: Angle in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rot_matrix</span> <span class="o">=</span> <span class="n">create_rotation_matrix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">local_matrix</span> <span class="o">=</span> <span class="n">rot_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">local_matrix</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">local_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.scale">
    <p>def <span class="ident">scale</span>(</p><p>self, x, y, z)</p>
    </div>
    

    
  
    <div class="desc"><p>Scale Mesh by given factors</p>
<p>This does not create a scale matrix and multiply existing matrix
with it. Instead, it will scale the vertices by given factors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.scale', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.scale" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Scale Mesh by given factors</span>
<span class="sd">    This does not create a scale matrix and multiply existing matrix</span>
<span class="sd">    with it. Instead, it will scale the vertices by given factors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fix_normals</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.select">
    <p>def <span class="ident">select</span>(</p><p>self, start, vector)</p>
    </div>
    

    
  
    <div class="desc"><p>Select test for object using bounding Sphere.</p>
<p>This method is not 100% accurate as it is based on a rough
assumption. Sphere area will be larger than actual object.</p>
<p>If you want to have a more accurate way to handle this, try
using raycast triangle intersect</p>
<p>Args:
  start: Starting point of the ray (such as eye position)
  vector: Ray direction. This is not the end point of a line!
          This is a unit vector showing the ray direction.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.select', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.select" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Select test for object using bounding Sphere.</span>
<span class="sd">    This method is not 100% accurate as it is based on a rough</span>
<span class="sd">    assumption. Sphere area will be larger than actual object.</span>
<span class="sd">    If you want to have a more accurate way to handle this, try</span>
<span class="sd">    using raycast triangle intersect</span>
<span class="sd">    Args:</span>
<span class="sd">      start: Starting point of the ray (such as eye position)</span>
<span class="sd">      vector: Ray direction. This is not the end point of a line!</span>
<span class="sd">              This is a unit vector showing the ray direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="n">raycast_sphere_intersect</span><span class="p">(</span>
        <span class="n">start</span><span class="p">,</span>
        <span class="n">vector</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounding_radius</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="ow">and</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.show">
    <p>def <span class="ident">show</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.show', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.show" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.step_back">
    <p>def <span class="ident">step_back</span>(</p><p>self, steps=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Go back N step in time</p>
<p>This is suitable for solving collisions and getting a step back.
On the other hand, this function requires <code>track_motion</code> to be
True.</p>
<p>Args:
  steps: Number of steps to go back. (Default = 1)</p>
<p>Returns:
  bool: If step back is successful</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.step_back', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.step_back" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">step_back</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Go back N step in time</span>
<span class="sd">    This is suitable for solving collisions and getting a step back.</span>
<span class="sd">    On the other hand, this function requires `track_motion` to be</span>
<span class="sd">    True.</span>
<span class="sd">    Args:</span>
<span class="sd">      steps: Number of steps to go back. (Default = 1)</span>
<span class="sd">    Returns:</span>
<span class="sd">      bool: If step back is successful</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_motion</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;track_motion should be True&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_path</span><span class="p">[</span><span class="o">-</span><span class="n">steps</span><span class="p">]</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_path</span><span class="p">[</span><span class="o">-</span><span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>  <span class="c1"># noqa</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.to_absolute">
    <p>def <span class="ident">to_absolute</span>(</p><p>self, coordinates)</p>
    </div>
    

    
  
    <div class="desc"><p>Return local coordinates (tuple, list) into absolute coordinates in
space.</p>
<p>Args:
  coordinates: List[float] (x, y, z)</p>
<p>Returns:
  List[float] (x', y', z')</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.to_absolute', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.to_absolute" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_absolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return local coordinates (tuple, list) into absolute coordinates in</span>
<span class="sd">    space.</span>
<span class="sd">    Args:</span>
<span class="sd">      coordinates: List[float] (x, y, z)</span>
<span class="sd">    Returns:</span>
<span class="sd">      List[float] (x&#39;, y&#39;, z&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vector_transform</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.to_dict">
    <p>def <span class="ident">to_dict</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.to_dict', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.to_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">,</span>
        <span class="s2">&quot;normals&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">,</span>
        <span class="s2">&quot;texcoords&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_texcoords</span><span class="p">,</span>
        <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
        <span class="s2">&quot;materials&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="n">mat</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">mat</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span>
        <span class="p">},</span>
        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="n">n</span><span class="p">:</span> <span class="n">cast</span><span class="p">(</span><span class="n">Mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">Mesh</span><span class="p">)</span>
        <span class="p">},</span>
    <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.to_json">
    <p>def <span class="ident">to_json</span>(</p><p>self, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.to_json', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.to_json" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.toggle_wireframe">
    <p>def <span class="ident">toggle_wireframe</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Toggle wireframe view of the Object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.toggle_wireframe', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.toggle_wireframe" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">toggle_wireframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Toggle wireframe view of the Object&quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">display</span>
    <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">d</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">toggle_wireframe</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.track">
    <p>def <span class="ident">track</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Track object motion</p>
<p>Returns:
    bool: <code>True</code> on successful tracking of <code>self</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.track', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.track" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">track</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Track object motion</span>
<span class="sd">    Returns:</span>
<span class="sd">        bool: `True` on successful tracking of `self`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_motion</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_previous_matrix</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="c1"># Add the new matrix to motion path records</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_motion_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">))</span>
    <span class="c1"># Add the matrix position to motion math line for visualisation</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_path_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_motion_path_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="p">)</span>
    <span class="c1"># Python trick here! need to .copy or it will pass reference.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_previous_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.update_matrix">
    <p>def <span class="ident">update_matrix</span>(</p><p>self, parent_matrix=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Update matrix</p>
<p>Turn object matrix into numpy array.</p>
<p>Args:
  parent_matrix: Parent objects matrix</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.update_matrix', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.update_matrix" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_matrix</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">parent_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Update matrix</span>
<span class="sd">    Turn object matrix into numpy array.</span>
<span class="sd">    Args:</span>
<span class="sd">      parent_matrix: Parent objects matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Turn matrix into numpy array. Numpy arrays are C Type arrays</span>
    <span class="c1"># suitable for OpenGL Pipeline</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="c1"># When there is a parent object, child object follows parents matrix</span>
    <span class="k">if</span> <span class="n">parent_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_matrix</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">parent_matrix</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.bounding_radius" class="name">var <span class="ident">bounding_radius</span></p>
            

            
  
    <div class="desc"><p>Return bounding radius</p>
<p>This property function <em>WILL NOT</em> update the previously
calculated value. If you add vertices to the object, you must call
<code>payton.scene.geometry.base.Object.refresh</code> function to get radius
and the whole object updated.</p>
<p>Returns:
  float</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.direction" class="name">var <span class="ident">direction</span></p>
            

            
  
    <div class="desc"><p>Get direction vector from Matrix</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.has_missing_vao" class="name">var <span class="ident">has_missing_vao</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.material" class="name">var <span class="ident">material</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.position" class="name">var <span class="ident">position</span></p>
            

            
  
    <div class="desc"><p>Get position of the Object.</p>
<p>Return matrix position list</p>
<p>Returns:
  List[float]</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.triangle_layout" class="name">var <span class="ident">triangle_layout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2.visible" class="name">var <span class="ident">visible</span></p>
            

            
  
    <div class="desc"><p>Check if object is visible</p>
<p>Returns:
  bool: <code>True</code> if visible.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.from_dict">
    <p>def <span class="ident">from_dict</span>(</p><p>cls, d)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.from_dict', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.from_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mesh&quot;</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="n">res</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;vertices&quot;</span><span class="p">]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;normals&quot;</span><span class="p">]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">_texcoords</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;texcoords&quot;</span><span class="p">]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">materials</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">n</span><span class="p">:</span> <span class="n">Material</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;materials&quot;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;materials&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="n">res</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">n</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;children&quot;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;children&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="payton.scene.geometry.md2.MD2.from_json">
    <p>def <span class="ident">from_json</span>(</p><p>cls, jstr)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2.from_json', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2.from_json" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">jstr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mesh&quot;</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">jstr</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="payton.scene.geometry.md2.MD2Frame" class="name">class <span class="ident">MD2Frame</span></p>
      
  
    <div class="desc"><p>MD2Frame(name, vertices, normals)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2Frame', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2Frame" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MD2Frame</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">vertices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">normals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#payton.scene.geometry.md2.MD2Frame">MD2Frame</a></li>
          <li>builtins.tuple</li>
          <li>builtins.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Frame.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Frame.normals" class="name">var <span class="ident">normals</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Frame.vertices" class="name">var <span class="ident">vertices</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="payton.scene.geometry.md2.MD2Header" class="name">class <span class="ident">MD2Header</span></p>
      
  
    <div class="desc"><p>MD2Header(ident, version, skin_width, skin_height, frame_size, num_skins, num_vertices, num_st, num_tris, num_glcmds, num_frames, offset_skins, offset_st, offset_tris, offset_frames, offset_glcmds, offset_end)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2Header', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2Header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MD2Header</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">ident</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">skin_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">skin_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">frame_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_skins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_vertices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_st</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_tris</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_glcmds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_skins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_st</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_tris</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_glcmds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">offset_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#payton.scene.geometry.md2.MD2Header">MD2Header</a></li>
          <li>builtins.tuple</li>
          <li>builtins.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.frame_size" class="name">var <span class="ident">frame_size</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 4</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.ident" class="name">var <span class="ident">ident</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_frames" class="name">var <span class="ident">num_frames</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 10</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_glcmds" class="name">var <span class="ident">num_glcmds</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 9</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_skins" class="name">var <span class="ident">num_skins</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 5</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_st" class="name">var <span class="ident">num_st</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 7</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_tris" class="name">var <span class="ident">num_tris</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 8</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.num_vertices" class="name">var <span class="ident">num_vertices</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 6</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_end" class="name">var <span class="ident">offset_end</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 16</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_frames" class="name">var <span class="ident">offset_frames</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 14</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_glcmds" class="name">var <span class="ident">offset_glcmds</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 15</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_skins" class="name">var <span class="ident">offset_skins</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 11</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_st" class="name">var <span class="ident">offset_st</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 12</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.offset_tris" class="name">var <span class="ident">offset_tris</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 13</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.skin_height" class="name">var <span class="ident">skin_height</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 3</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.skin_width" class="name">var <span class="ident">skin_width</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2Header.version" class="name">var <span class="ident">version</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="payton.scene.geometry.md2.MD2TriangleLayout" class="name">class <span class="ident">MD2TriangleLayout</span></p>
      
  
    <div class="desc"><p>MD2TriangleLayout(vertex_indices, tc_indices)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-payton.scene.geometry.md2.MD2TriangleLayout', this);">Show source &equiv;</a></p>
  <div id="source-payton.scene.geometry.md2.MD2TriangleLayout" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MD2TriangleLayout</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">vertex_indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tc_indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#payton.scene.geometry.md2.MD2TriangleLayout">MD2TriangleLayout</a></li>
          <li>builtins.tuple</li>
          <li>builtins.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2TriangleLayout.tc_indices" class="name">var <span class="ident">tc_indices</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="payton.scene.geometry.md2.MD2TriangleLayout.vertex_indices" class="name">var <span class="ident">vertex_indices</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
